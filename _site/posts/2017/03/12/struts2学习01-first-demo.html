<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta http-equiv="content-language" content="zh-CN" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
		<meta name="keywords" content="TMaize,java"/>
		<meta name="author" content="TMaize" />
		<meta name="description" content="Struts2学习-01 First Demo"/>
		<link rel="icon" href="/static/img/favicon.ico" type="image/x-icon" />
		<link rel="shortcut icon" href="/static/img/favicon.ico" type="image/x-icon"/>
		<link rel="stylesheet" href="/static/css/blog.css">
		<link rel="stylesheet" href="/static/css/blog-post.css">
		<script>window.blog={contextPath:""}</script>
		<script type="text/javascript" src="/static/js/blog.js"></script>
		<title>Struts2学习-01 First Demo-TMaize Blog</title>
	</head>
<body>
<header class="header select-none">
    <a class="logo" title="TMaize Blog" href="/">
        <img src="/static/img/logo.jpg">
    </a>
    <a class="title" href="/">TMaize Blog</a>
    <nav class="menu">
        <a href="/">Blog</a>
        <a href="/pages/categories.html">Categories</a>
        <a href="/pages/search.html">Search</a>
        <a href="/pages/links.html">Links</a>
        <a href="/pages/chat.html">Chat</a>
        <a href="/pages/about.html">About</a>
    </nav>
    <span class="icon"></span>
</header>
	<div class="main animation-fadeUp post">
		
		<h1 class="title">Struts2学习-01 First Demo</h1>
		
		<div class="content"><h2 id="section">基本步骤</h2>

<ul>
  <li>
    <p>去<a href="http://struts.apache.org/">Struts官网</a>下载最新的开发包</p>
  </li>
  <li>
    <p>Eclipse新建web项目</p>
  </li>
  <li>
    <p>导入jar包</p>
  </li>
</ul>

<p><code class="highlighter-rouge">java
 /** 
    Struts2.5用到的基础开发包 
    注意不要导入暂时不需要的的jar包，否则会出现404错误
    commons-fileupload-1.3.1.jar 
    commons-io-2.2.jar 
    commons-lang-2.4.jar 
    commons-lang3-3.1.jar 
    commons-logging-1.1.3.jar 
    freemarker-2.3.19.jar 
    javassist-3.11.0.GA.jar 
    log4j-1.2.14.jar 
    ognl-3.0.6.jar 
    struts2-core-2.3.16.3.jar 
    xwork-core-2.3.16.3.jar (最新版本已经合并到struts2-core)
*/  
</code></p>

<ul>
  <li>配置过滤器</li>
</ul>

<p>```xml
//web.xml文件
<?xml version="1.0" encoding="UTF-8"?></p>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemalocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
  <display-name>day01</display-name>
  
  <filter>
        <filter-name>struts2</filter-name>
        <filter-class>org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>struts2</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.jsp</welcome-file>
  </welcome-file-list>
</web-app>
<p>```</p>

<ul>
  <li>建立Test.java文件</li>
</ul>

<p>```java
package com.day01;</p>

<p>public class Test {</p>

<div class="highlighter-rouge"><pre class="highlight"><code>//会自动执行这个
public String execute(){
	return "ok";
} } ```
</code></pre>
</div>

<ul>
  <li>创建Struts配置文件(在src根目录)</li>
</ul>

<p>```xml
<?xml version="1.0" encoding="UTF-8" ?></p>

<p>&lt;!DOCTYPE struts PUBLIC
        “-//Apache Software Foundation//DTD Struts Configuration 2.5//EN”
        “http://struts.apache.org/dtds/struts-2.5.dtd”&gt;</p>
<struts>
    <package name="testdemo" extends="struts-default" namespace="/">
        <action name="test" class="com.day01.Test">
        	<result name="ok">/test.jsp</result>
        </action>
    </package>
</struts>
<p>```</p>

<ul>
  <li>创建视图test.jsp(在WebContent根目录)</li>
</ul>

<p>```jsp
&lt;%@ page language=”java” %&gt;
&lt;%@ page contentType=”text/html; charset=UTF-8” %&gt;
&lt;%@ page pageEncoding=”UTF-8”%&gt;
&lt;!DOCTYPE html&gt;</p>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>Test</title>
	</head>
	<body>
	Demo测试成功
	</body>
</html>
<p>```</p>

<ul>
  <li>运行项目</li>
</ul>

<p>如果访问地址<code class="highlighter-rouge">http://localhost:8080/项目名/test</code>或<code class="highlighter-rouge">http://localhost:8080/项目名/test.action</code>出现’Demo测试成功’则环境搭建成功</p>

<h2 id="section-1">运行过程</h2>

<ul>
  <li>
    <p>浏览器发送请求</p>
  </li>
  <li>
    <p>过滤器的匹配模式为/*所以会经过过滤器</p>
  </li>
  <li>
    <p>过滤器获得请求路径，得到test这个值</p>
  </li>
  <li>
    <p>到src下找到struts.xml</p>
  </li>
  <li>
    <p>解析到<code class="highlighter-rouge">&lt;action name="test" class="com.day01.Test"&gt;</code></p>
  </li>
  <li>
    <p>得到Action即clss路径</p>
  </li>
  <li>
    <p>利用反射执行Test的execute方法得到返回值</p>
  </li>
</ul>

<p><code class="highlighter-rouge">java
Class&lt;?&gt; clazz = Class.forName("com.day01.Test");
Method method = clazz.getMethod("execute");
Object object = method.invoke(clazz.newInstance(), null);
</code></p>

<ul>
  <li>
    <p>根据返回值与多个result匹配<code class="highlighter-rouge">&lt;result name="ok"&gt;/test.jsp&lt;/result&gt;</code>得到视图</p>
  </li>
  <li>
    <p>向用户展示jsp页面</p>
  </li>
</ul>
</div>
	</div>
<footer class="footer">
    <span>Copyright © 2016 皖ICP备16016174号</span>
    <a href="/sitemap.xml">网站地图</a>
    <span>Powered by</span>
    <a href="https://github.com/TMaize/tmaize-blog">tmaize-blog</a>
    <div class="up"></div>
</footer>
<script>
    //mta.qq.com 访问统计
    var _mtac = {};
    (function() {
        var mta = document.createElement("script");
        mta.src = "http://pingjs.qq.com/h5/stats.js?v2.0.2";
        mta.setAttribute("name", "MTAH5");
        mta.setAttribute("sid", "500581966");
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(mta, s);
    })();
    //360的自动推送
    (function(){
        var src = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?0b7f3f19682121293c3e4b62c9740281":"https://jspassport.ssl.qhimg.com/11.0.1.js?0b7f3f19682121293c3e4b62c9740281";
        document.write('<script src="' + src + '" id="sozz"><\/script>');
    })();
    //百度的自动推送
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
</body>
</html>
