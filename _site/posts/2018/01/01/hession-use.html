<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta http-equiv="content-language" content="zh-CN" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
		<meta name="keywords" content="TMaize,java"/>
		<meta name="author" content="TMaize" />
		<meta name="description" content="Hession使用"/>
		<link rel="icon" href="/static/img/favicon.ico" type="image/x-icon" />
		<link rel="shortcut icon" href="/static/img/favicon.ico" type="image/x-icon"/>
		<link rel="stylesheet" href="/static/css/blog.css">
		<link rel="stylesheet" href="/static/css/blog-post.css">
		<script>window.blog={contextPath:""}</script>
		<script type="text/javascript" src="/static/js/blog.js"></script>
		<title>Hession使用-TMaize Blog</title>
	</head>
<body>
<header class="header select-none">
    <a class="logo" title="TMaize Blog" href="/">
        <img src="/static/img/logo.jpg">
    </a>
    <a class="title" href="/">TMaize Blog</a>
    <nav class="menu">
        <a href="/">Blog</a>
        <a href="/pages/categories.html">Categories</a>
        <a href="/pages/search.html">Search</a>
        <a href="/pages/links.html">Links</a>
        <a href="/pages/chat.html">Chat</a>
        <a href="/pages/about.html">About</a>
    </nav>
    <span class="icon"></span>
</header>
	<div class="main animation-fadeUp post">
		
		<h1 class="title">Hession使用</h1>
		
		<div class="content"><p>Hessian是一个轻量级的RPC框架</p>

<p>它基于HTTP协议传输，使用Hessian二进制序列化(所以使用post请求)，对于数据包比较大的情况比较友好。</p>

<p>Hessian通常通过Web应用来提供服务，因此非常类似于WebService。只是它不使用SOAP协议。</p>

<h2 id="section">要求</h2>

<blockquote>
  <p>服务端</p>
</blockquote>

<ol>
  <li>
    <p>包含Hessian的jar包</p>
  </li>
  <li>
    <p>javaBean要实现Serializable接口</p>
  </li>
  <li>
    <p>接口及接口的实现</p>
  </li>
  <li>
    <p>配置web.xml,配置相应的servlet</p>
  </li>
</ol>

<blockquote>
  <p>客户端</p>
</blockquote>

<ol>
  <li>
    <p>包含Hessian的jar包</p>
  </li>
  <li>
    <p>服务端把相关javaBean和接口导出为jar包提供给客户端使用</p>
  </li>
</ol>

<p><strong>注意</strong></p>

<p>参数及返回值需实现Serializable接口</p>

<p>参数及返回值不能为自定义实现List, Map, Number, Date, Calendar等接口，只能用JDK自带的实现，因为hessian会做特殊处理，自定义实现类中的属性值都会丢失。</p>

<h2 id="demo">Demo</h2>

<p>服务端代码</p>

<p>```java
public class User implements Serializable {
    private static final long serialVersionUID = 2129368418409890807L;
    private String name;
    private int age;</p>

<div class="highlighter-rouge"><pre class="highlight"><code>//getter/setter.... } ```
</code></pre>
</div>

<p><code class="highlighter-rouge">java
public interface UserService {
    public List&lt;User&gt; listUser();
}
</code></p>

<p>```java
public class UserServiceImpl implements UserService{</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Override
public List&lt;User&gt; listUser() {
    List&lt;User&gt; list = new ArrayList&lt;User&gt;();
    list.add(new User("张三",18));
    list.add(new User("李四",19));
    return list;
} }
</code></pre>
</div>

<p>```</p>

<p>```xml</p>
<servlet>
    <servlet-name>UserService</servlet-name>
    <servlet-class>com.caucho.hessian.server.HessianServlet</servlet-class>
    <!-- 配置接口的具体实现类，service-class，home-class都可以 -->
    <init-param>
        <param-name>home-class</param-name>
        <param-value>net.tmaize.demo.service.impl.UserServiceImpl</param-value>
    </init-param>
</servlet>

<servlet-mapping>
    <servlet-name>UserService</servlet-name>
    <url-pattern>/rpc/UserService</url-pattern>
</servlet-mapping>
<p>```</p>

<p>客户端代码</p>

<p>服务端先导出jar文件为客户端使用</p>

<p><code class="highlighter-rouge">java
String url = "http://127.0.0.1:8080/hession-demo/rpc/UserService";
HessianProxyFactory factory = new HessianProxyFactory();
UserService userService = (UserService) factory.create(UserService.class, url);
List&lt;User&gt; list = userService.listUser();
System.out.println(new Gson().toJson(list));
</code></p>

<h2 id="section-1">简化</h2>

<p>xml还可而已这样配置,其他略….</p>

<p>```
UserServiceImpl继承HessianServlet实现UserService</p>

<p>public class UserServiceImpl extends HessianServlet implements UserService</p>

<servlet>
    <servlet-name>UserService</servlet-name>
    <servlet-class>net.tmaize.demo.service.impl.UserServiceImpl</servlet-class>
</servlet>
<p>```</p>

<p><img src="01.png" alt="hession" /></p>
</div>
	</div>
<footer class="footer">
    <span>Copyright © 2016 皖ICP备16016174号</span>
    <a href="/sitemap.xml">网站地图</a>
    <span>Powered by</span>
    <a href="https://github.com/TMaize/tmaize-blog">tmaize-blog</a>
    <div class="up"></div>
</footer>
<script>
    //mta.qq.com 访问统计
    var _mtac = {};
    (function() {
        var mta = document.createElement("script");
        mta.src = "http://pingjs.qq.com/h5/stats.js?v2.0.2";
        mta.setAttribute("name", "MTAH5");
        mta.setAttribute("sid", "500581966");
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(mta, s);
    })();
    //360的自动推送
    (function(){
        var src = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?0b7f3f19682121293c3e4b62c9740281":"https://jspassport.ssl.qhimg.com/11.0.1.js?0b7f3f19682121293c3e4b62c9740281";
        document.write('<script src="' + src + '" id="sozz"><\/script>');
    })();
    //百度的自动推送
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
</body>
</html>
